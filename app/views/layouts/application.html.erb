<!DOCTYPE html>
<html lang="en">
  <head>
    <title><%= page_title %></title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta charset="utf-8">
    <% unless request.get? && !form_request? # prevent turbo for caching form redisplays, which will often contain validation messages %>
      <meta name="turbo-cache-control" content="no-cache">
    <% end %>
    <meta name="turbo-prefetch" content="false"> <%# ask turbo not to prefetch links on hover %>
    <%= yield :head %>
    <%= javascript_include_tag "application", "data-turbo-track": "reload", defer: true %>
    <%= stylesheet_link_tag "application", media: "all", "data-turbo-track": "reload" %>
  </head>

<%= tag.body class: "public #{@body_class}" do %>

    <div class="accessibility-links" role="navigation" data-turbo="false">
      <%= link_to "Skip to content", "#content-start" %>
    </div>

    <header class="header">
      <nav class="container grid-lg">
        <%= link_to account_home_path, class: "logo-link" do %>
          <%= logo small: true, alt: "#{current_library.name} logo" %>
        <% end %>
        <div class="search-and-menu-icon">
          <%= render "shared/search" %>
          <label class="icon-container btn btn-action btn-lg" for="menu-toggle">
            <i class="icon icon-menu" aria-hidden="true"></i>
            <span class="visually-hidden">Toggle navigation</span>
          </label>
          <input id="menu-toggle" class="visually-hidden" type="checkbox" />
          <label class="expanded-menu-label" for="menu-toggle">
            <span class="visually-hidden">Toggle navigation</span>
          </label>
        </div>
        <ul class="navigation-links">
          <li>
            <span class="link-group-label" id="nav-borrow-tools-label">Borrow Tools</span>
            <ul aria-labelledby="nav-borrow-tools-label">
              <li class="navigation-link"><%= link_to "Inventory", items_path, class: "btn btn-link" %></li>
              <li class="navigation-link"><%= link_to "Loans", account_loans_path, class: "btn btn-link" %></li>
              <li class="navigation-link"><%= link_to "Holds", account_holds_path, class: "btn btn-link" %></li>
              <li class="navigation-link"><%= link_to "Appointments", account_appointments_path, class: "btn btn-link" %></li>
            </ul>
          </li>
          <li>
            <span class="link-group-label" id="nav-membership-label">Membership</span>
            <ul aria-labelledby="nav-membership-label">
              <li class="navigation-link"><%= link_to "Profile", account_member_path, class: "btn btn-link" %></li>
              <% if current_user&.admin? %>
                <li class="navigation-link"><%= link_to "Librarian View", admin_dashboard_path, class: "btn btn-link" %></li>
              <% end %>
            </ul>
          </li>
          <li>
            <span class="link-group-label" id="nav-about-us-label">About Us</span>
            <ul aria-labelledby="nav-about-us-label">
              <li class="navigation-link"><%= link_to "Hours & Location", account_home_path, class: "btn btn-link" %></li>
              <li class="navigation-link"><%= link_to "Contact Us", "https://www.chicagotoollibrary.org/", class: "btn btn-link" %></li>
              <li class="navigation-link"><%= link_to "Visit Our Website", "https://www.chicagotoollibrary.org/", class: "btn btn-link" %></li>
            </ul>
          </li>
        </ul>
      </nav>
    </header>

    <%
=begin%>
 <div class="off-canvas" data-controller="sidebar">
      <div id="sidebar-id" class="off-canvas-sidebar" data-sidebar-target="menu" style="background-color: teal;">
        <ul class="nav">
          <%= render partial: "shared/navbar_links" %>
        </ul>
      </div>

      <a class="off-canvas-overlay" href="#close" data-action="sidebar#close" title="close sidebar"></a>

      <div class="off-canvas-content show-sm mobile-banner">
        <div class="mobile-banner-content">
          <div class="logo">
            <a href="https://chicagotoollibrary.org/">
              <%= logo(small: true) %>
            </a>
          </div>

          <%= render "shared/search" %>
        </div>
      </div>

      <a class="off-canvas-toggle btn btn-action btn-lg show-sm" href="#sidebar-id" data-action="sidebar#open" title="show sidebar nvigation">
        <i class="icon icon-menu"></i>
      </a>
    </div>
<%
=end%>

    <div class="container grid-lg public">

      <%
=begin%>
 <header class="navbar hide-sm" style="background-color: papayawhip;">
        <section class="navbar-section">
          <span class="navbar-brand mr-3">
            <a href="https://chicagotoollibrary.org/">
              <%= image_tag "logo_small.png", alt: "Chicago Tool Library logo" %>
            </a>
          </span>
          <ul class="navbar-links">
            <%= render partial: "shared/navbar_links" %>
          </ul>
        </section>
        <section class="navbar-section search-section">
          <%= render "shared/search", id: "navbarQuery" %>
        </section>
      </header>
<%
=end%>

      <%= render partial: "shared/time_override" if Rails.env.development? %>

      <main id="content-start">
        <% if content_for? :header %>
          <div class="app-header">
            <div class="header-header">
              <%= yield :header %>
            </div>
          </div>
        <% end %>

        <div class="app-body">
          <%= flash_message :success %>
          <%= flash_message :warning %>
          <%= flash_message :error %>
          <%= flash_message :alert, "error" %>

          <%= render(partial: "account/membership_renewal_message") if user_signed_in? %>

          <%= yield %>
        </div>
      </main>
    </div>

    <%= render partial: "layouts/footer", object: @member, as: :member %>
  <% end %>
</html>
