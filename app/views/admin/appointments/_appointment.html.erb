<div id="<%= dom_id(appointment) %>" class="card" style="<%= 'opacity:0.6' if appointment.completed? %>">
  <div class="card-header">
    <div class="card-title h5">
      <%= link_to preferred_or_default_name(appointment.member), admin_member_path(appointment.member) %><br>
    </div>
    <div class="card-subtitle text-gray">
      <%= l appointment.starts_at, format: :hour %> - <%= l appointment.ends_at, format: :hour %>
    </div>
  </div>
  <div class="card-body">
      <div class="columns">
        <% if !appointment.holds.empty? =%>
          <div class="column col-md-6 col-sm-12" style="margin-bottom:16px">
            <div class="columns">
              <div class="column col-12">
                <h2>Pickup Items</h2>
                <div class="columns">
                  <div class="column col-4"><b>Item Name</b></div>
                  <div class="column col-4"><b>Item ID</b></div>           
                  <div class="column col-4"><b>Category</b></div>
                </div>
                <% appointment.holds.take(10).each do |hold| %>
                  <div class="columns">
                    <div class="column col-4">
                      <%= link_to hold.item.name, admin_item_path(hold.item), title: hold.item.complete_number %>
                    </div>
                    <div class="column col-4">
                      <%= hold.item.complete_number %>
                    </div>
                    <div class="column col-4">
                      <% if hold.item.categories.size > 0 %>
                          <% hold.item.categories.sort_by(&:name).each do |category| %>
                              <p><%= category.name %></p>
                          <% end %>
                      <% end %>
                    </div>
                  </div>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
        <% if !appointment.loans.empty? =%>
          <div class="column col-md-6 col-sm-12">
            <div class="columns">
              <div class="column col-12">
                <h2>Dropoff Items</h2>
                <div class="columns">
                  <div class="column col-4"><b>Item Name</b></div>
                  <div class="column col-4"><b>Item ID</b></div>           
                  <div class="column col-4"><b>Category</b></div>
                </div>
                <% appointment.loans.take(10).each do |loan| %>
                  <div class="columns">
                    <div class="column col-4">
                      <%= link_to loan.item.name, admin_item_path(loan.item), title: loan.item.complete_number %>
                    </div>
                    <div class="column col-4">
                      <%= loan.item.complete_number %>
                    </div>
                    <div class="column col-4">
                      <% if loan.item.categories.size > 0 %>
                          <% loan.item.categories.sort_by(&:name).each do |category| %>
                              <p><%= category.name %></p>
                          <% end %>
                      <% end %>
                    </div>
                  </div>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div> 
  <div class="card-footer">
    <div class="float-right">
      <%= button_to "View / Edit", admin_appointment_path(appointment), method: :get, class: "btn btn-primary", data: {disable_with: "saving"} %>
      <% if appointment.completed? %>
        <%= button_to "Restore", admin_appointment_completion_path(appointment),
              method: :delete, class: "btn btn-primary", data: {turbo_stream: true, turbo_disable: "saving"} %>
      <% else %>
        <%= button_to "Complete", admin_appointment_completion_path(appointment),
              method: :post, class: "btn btn-primary", data: {disable_with: "saving"} %>
      <% end %>
    </div>
  </div>
</div>